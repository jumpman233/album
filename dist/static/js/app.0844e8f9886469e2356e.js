webpackJsonp([1],{"/Hv2":function(e,i){},NHnr:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=t("IvJb"),a={render:function(){var e=this.$createElement,i=this._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},staticRenderFns:[]};var s=t("C7Lr")({name:"App"},a,!1,function(e){t("m6Gp")},null,null).exports,o=t("zO6J"),l=t("4YfN"),r=t.n(l),c=t("t+b9"),d=t.n(c),u=t("aozt"),g=t.n(u),p=t("9rMa"),h={name:"HelloWorld",data:function(){return{msg:"Welcome to Your Vue.js App",deleteMode:!1,loginDialogVisible:!1,loginDialogLoading:!1,loginSuccessVisible:!1,loginFailVisible:!1,inputUsername:"",inputPassword:"",loginFailMsg:"",registerDialogVisible:!1,registerDialogLoading:!1,registerSuccessVisible:!1,registerFailVisible:!1,inputRegisterUsername:"",inputRegisterPassword:"",registerFailMsg:"",newFolderDialogVisible:!1,newFolderDialogLoading:!1,newFolderSuccessVisible:!1,newFolderFailVisible:!1,inputFolderName:"",newFolderFailMsg:"",uploadSuccessVisible:!1,uploadFailVisible:!1,uploadFailMsg:"",deleteDialogVisible:!1,deleteDialogLoading:!1,deleteSuccessVisible:!1,deleteFailVisible:!1,deleteFailMsg:"",containerLoadingVisible:!1,imgDetailVisible:!1,curImgUrl:"",curImgName:""}},computed:r()({paths:function(){var e=this,i=this.dirs.filter(function(e){return e.checked}),t=this.photos.filter(function(e){return e.checked}),n=[];return i.forEach(function(i){n.push(e.curPath+"/"+i.name)}),t.forEach(function(i){n.push(e.curPath+"/"+i.name)}),n},isEmpty:function(){return 0===this.dirs.length&&0===this.photos.length},sepPath:function(){return this.curPath.split("/").filter(function(e){return""!==e})}},Object(p.b)(["isLogin","username","dirs","photos","curPath"])),created:function(){var e=this;this.$store.dispatch("getInfo"),this.containerLoadingVisible=!0,this.$store.dispatch("getDir",{path:""}).then(function(){return e.containerLoadingVisible=!1},function(){return e.containerLoadingVisible=!1})},components:{Container:c.Container,Header:c.Header,Footer:c.Footer,Main:c.Main,Button:c.Button,Dialog:c.Dialog,Input:c.Input,Checkbox:c.Checkbox,BreadcrumbItem:c.BreadcrumbItem,Breadcrumb:c.Breadcrumb},methods:{upload:function(){document.getElementById("upload").click()},change:function(){var e=document.getElementById("upload").files[0],i=this;if(e){var t=new FormData,n=new FileReader;n.onload=function(){t.append("name",e.name),t.append("path",i.curPath||""),t.append("file",this.result),i.containerLoadingVisible=!0,i.$store.dispatch("uploadImg",t).then(function(e){i.containerLoadingVisible=!1,"success"===e?i.uploadSuccessVisible=!0:(i.uploadFailVisible=!0,i.uploadFailMsg=e||"something wrong")},function(e){i.containerLoadingVisible=!1,i.uploadFailVisible=!0,i.uploadFailMsg=e||"something wrong"})},n.readAsDataURL(e)}},clickLogin:function(){var e=this;this.loginDialogLoading=!0,this.$store.dispatch("login",{username:this.inputUsername,password:this.inputPassword}).then(function(i){e.loginDialogLoading=!1,e.loginDialogVisible=!1,e.isLogin?(e.loginSuccessVisible=!0,e.$store.dispatch("getDir",{path:e.curPath})):(e.loginFailVisible=!0,e.loginFailMsg="Login fail: "+(i||"something wrong"))},function(i){e.loginDialogLoading=!1,e.loginDialogVisible=!1,e.loginFailVisible=!0,e.loginFailMsg="Login fail: "+(i||"something wrong")})},clickRegister:function(){var e=this;this.registerDialogLoading=!0,this.$store.dispatch("register",{username:this.inputRegisterUsername,password:this.inputRegisterPassword}).then(function(i){e.registerDialogLoading=!1,e.registerDialogVisible=!1,e.isLogin?(e.registerSuccessVisible=!0,e.$store.dispatch("getDir",{path:e.curPath})):(e.registerFailVisible=!0,e.registerFailMsg="Register fail: "+(i||"something wrong"))},function(i){e.registerDialogLoading=!1,e.registerFailVisible=!0,e.registerFailMsg="Register fail: "+(i||"something wrong")})},clickConfirmDelete:function(){0!==this.paths.length?this.deleteDialogVisible=!0:this.deleteMode=!1},clickFolder:function(e){var i=this;this.deleteMode?e.checked=!e.checked:(this.containerLoadingVisible=!0,this.$store.dispatch("getDir",{path:this.curPath+"/"+e.name}).then(function(){return i.containerLoadingVisible=!1},function(){return i.containerLoadingVisible=!1}))},clickPhoto:function(e){this.deleteMode?e.checked=!e.checked:(this.imgDetailVisible=!0,this.curImgName=e.name,this.curImgUrl=e.url)},clickPath:function(e,i){var t=this;this.containerLoadingVisible=!0,console.log(this.sepPath.slice(0,i+1).join("/")),this.$store.dispatch("getDir",{path:this.sepPath.slice(0,i+1).join("/")}).then(function(){return t.containerLoadingVisible=!1},function(){return t.containerLoadingVisible=!1})},clickNewFolder:function(){var e=this;this.newFolderDialogLoading=!0,this.$store.dispatch("newFolder",{path:this.curPath,dirName:this.inputFolderName}).then(function(i){e.newFolderDialogLoading=!1,e.newFolderDialogVisible=!1,"success"===i?e.newFolderSuccessVisible=!0:(e.newFolderFailVisible=!0,e.newFolderFailMsg="create fail: "+(i||"something wrong"))},function(i){e.newFolderDialogLoading=!1,e.newFolderFailVisible=!0,e.newFolderFailMsg="create fail: "+(i||"something wrong")})},returnPrev:function(){var e=this;this.curPath&&(this.containerLoadingVisible=!0,this.$store.dispatch("getDir",{path:this.curPath.substring(0,this.curPath.lastIndexOf("/"))}).then(function(){return e.containerLoadingVisible=!1},function(){return e.containerLoadingVisible=!1}))},deletePath:function(){var e=this;0!==this.paths.length?(this.deleteDialogLoading=!0,this.$store.dispatch("deletePath",{path:this.paths}).then(function(i){e.deleteDialogLoading=!1,e.deleteMode=!1,e.deleteDialogVisible=!1,"success"===i?e.deleteSuccessVisible=!0:(e.deleteFailVisible=!0,e.deleteFailMsg=i||"something wrong")},function(i){e.deleteDialogLoading=!1,e.deleteMode=!1,e.deleteFailVisible=!0,e.deleteFailMsg=i||"something wrong"})):this.deleteMode=!1},logout:function(){this.$store.dispatch("logout").then(function(){})}}},m={render:function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("div",[n("el-container",[n("el-header",{staticClass:"page-header"},[n("div",{staticClass:"logo-wrapper"},[n("img",{staticClass:"logo",attrs:{src:t("plIk"),alt:""}})]),e._v(" "),n("div",[e.username?n("span",{staticClass:"username"},[e._v("Hi, "),n("strong",[e._v(e._s(e.username))])]):e._e(),e._v(" "),e.isLogin?e._e():n("el-button",{attrs:{type:"primary",round:""},on:{click:function(i){e.loginDialogVisible=!0}}},[e._v("\n          Login\n        ")]),e._v(" "),e.isLogin?e._e():n("el-button",{attrs:{type:"primary",round:""},on:{click:function(i){e.registerDialogVisible=!0}}},[e._v("\n          Register\n        ")]),e._v(" "),e.isLogin?n("el-button",{attrs:{type:"primary",round:""},on:{click:function(i){e.logout()}}},[e._v("Log Out")]):e._e()],1)]),e._v(" "),n("el-main",{directives:[{name:"loading",rawName:"v-loading",value:e.containerLoadingVisible,expression:"containerLoadingVisible"}],staticClass:"page-main"},[e.isLogin?n("div",{staticClass:"btn-group"},[n("el-button",{attrs:{type:"primary",icon:"el-icon-upload2"},on:{click:function(i){e.upload()}}},[e._v("\n          Upload "),n("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"upload"},on:{change:function(i){e.change()}}})]),e._v(" "),e.curPath?n("el-button",{attrs:{type:"primary",icon:"el-icon-back"},on:{click:function(i){e.returnPrev()}}},[e._v("Return")]):e._e(),e._v(" "),e.deleteMode?e._e():n("el-button",{attrs:{type:"primary",icon:"el-icon-delete"},on:{click:function(i){e.deleteMode=!e.deleteMode}}},[e._v("\n          Delete\n        ")]),e._v(" "),e.deleteMode?n("el-button",{attrs:{type:"primary"},on:{click:function(i){e.clickConfirmDelete()}}},[e._v("\n          "+e._s(0===e.paths.length?"Cancel Delete":"Confirm Delete")+"\n        ")]):e._e(),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(i){e.newFolderDialogVisible=!0}}},[e._v("New Folder")])],1):e._e(),e._v(" "),e.isLogin?n("div",{staticClass:"path"},[e._v("\n        Current Path:\n        "),n("el-breadcrumb",{attrs:{separator:"/"}},[n("el-breadcrumb-item",[n("a",{attrs:{href:"javascript:;"},on:{click:function(i){e.clickPath("/",-1)}}},[e._v("home")])]),e._v(" "),e._l(e.sepPath,function(i,t){return n("el-breadcrumb-item",{key:t},[n("a",{attrs:{href:"javascript:;"},on:{click:function(n){e.clickPath(i,t)}}},[e._v(e._s(i))])])})],2)],1):e._e(),e._v(" "),n("div",{staticClass:"main-wrapper"},[e._l(e.dirs,function(i,t){return n("div",{key:i.name,staticClass:"folder item",attrs:{title:i.name},on:{click:function(t){e.clickFolder(i)}}},[n("i",{staticClass:"folder-bk"}),e._v(" "),e.deleteMode?n("el-checkbox",{staticClass:"item-text",model:{value:i.checked,callback:function(t){e.$set(i,"checked",t)},expression:"dir.checked"}},[e._v("\n            "+e._s(i.name)+"\n          ")]):e._e(),e._v(" "),e.deleteMode?e._e():n("p",{staticClass:"item-text"},[e._v("\n            "+e._s(i.name))])],1)}),e._v(" "),e._l(e.photos,function(i,t){return n("div",{key:i.name,staticClass:"photo item",attrs:{title:i.name},on:{click:function(t){e.clickPhoto(i)}}},[n("img",{attrs:{src:i.url,alt:i.name}}),e._v(" "),e.deleteMode?n("el-checkbox",{staticClass:"item-text",model:{value:i.checked,callback:function(t){e.$set(i,"checked",t)},expression:"photo.checked"}},[e._v("\n            "+e._s(i.name)+"\n          ")]):e._e(),e._v(" "),e.deleteMode?e._e():n("p",{staticClass:"item-text"},[e._v("\n            "+e._s(i.name))])],1)})],2),e._v(" "),e.isLogin?e._e():n("div",{staticClass:"tip-login"},[e._v("\n        Please\n        "),n("a",{attrs:{href:"javascript:;"},on:{click:function(i){e.loginDialogVisible=!0}}},[e._v("Login")]),e._v("\n        first to visit your album\n      ")]),e._v(" "),e.isLogin&&e.isEmpty?n("div",{staticClass:"tip-upload"},[e._v("\n        The directory is empty. You can\n        "),n("a",{attrs:{href:"javascript:;"},on:{click:function(i){e.newFolderDialogVisible=!0}}},[e._v("Create Folder")]),e._v("\n        or\n        "),n("a",{attrs:{href:"javascript:;"},on:{click:function(i){e.upload()}}},[e._v("Upload Img")])]):e._e()])],1),e._v(" "),e.imgDetailVisible?n("div",{staticClass:"img-detail-wrapper"},[n("i",{staticClass:"icon-close",on:{click:function(i){e.imgDetailVisible=!1}}}),e._v(" "),n("div",{staticClass:"img-detail-header"},[e._v("\n      "+e._s(e.curImgName)+"\n    ")]),e._v(" "),n("div",{staticClass:"img-wrapper"},[n("img",{attrs:{src:e.curImgUrl,alt:e.curImgName}})])]):e._e(),e._v(" "),n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.registerDialogLoading,expression:"registerDialogLoading"}],attrs:{title:"Register",visible:e.registerDialogVisible,width:"50%"},on:{"update:visible":function(i){e.registerDialogVisible=i}}},[n("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"Your Username"},model:{value:e.inputRegisterUsername,callback:function(i){e.inputRegisterUsername=i},expression:"inputRegisterUsername"}}),e._v(" "),n("el-input",{attrs:{placeholder:"Your Password",type:"password"},model:{value:e.inputRegisterPassword,callback:function(i){e.inputRegisterPassword=i},expression:"inputRegisterPassword"}}),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(i){e.registerDialogVisible=!1}}},[e._v("Cancel")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(i){e.clickRegister()}}},[e._v("Confirm")])],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"Register Success",visible:e.registerSuccessVisible,width:"50%"},on:{"update:visible":function(i){e.registerSuccessVisible=i}}},[n("span",[e._v("Welcome, "),n("strong",[e._v(e._s(e.username))])])]),e._v(" "),n("el-dialog",{attrs:{title:"Register Fail",visible:e.registerFailVisible,width:"50%"},on:{"update:visible":function(i){e.registerFailVisible=i}}},[n("span",[e._v(e._s(e.registerFailMsg))])]),e._v(" "),n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loginDialogLoading,expression:"loginDialogLoading"}],attrs:{title:"Login",visible:e.loginDialogVisible,width:"50%"},on:{"update:visible":function(i){e.loginDialogVisible=i}}},[n("el-input",{staticStyle:{"margin-bottom":"20px"},attrs:{placeholder:"Your Username"},model:{value:e.inputUsername,callback:function(i){e.inputUsername=i},expression:"inputUsername"}}),e._v(" "),n("el-input",{attrs:{placeholder:"Your Password",type:"password"},model:{value:e.inputPassword,callback:function(i){e.inputPassword=i},expression:"inputPassword"}}),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(i){e.loginDialogVisible=!1}}},[e._v("Cancel")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(i){e.clickLogin()}}},[e._v("Confirm")])],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"Login Success",visible:e.loginSuccessVisible,width:"50%"},on:{"update:visible":function(i){e.loginSuccessVisible=i}}},[n("span",[e._v("Welcome back, "),n("strong",[e._v(e._s(e.username))])])]),e._v(" "),n("el-dialog",{attrs:{title:"Login Fail",visible:e.loginFailVisible,width:"50%"},on:{"update:visible":function(i){e.loginFailVisible=i}}},[n("span",[e._v(e._s(e.loginFailMsg))])]),e._v(" "),n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.newFolderDialogLoading,expression:"newFolderDialogLoading"}],attrs:{title:"New Folder",visible:e.newFolderDialogVisible,width:"50%"},on:{"update:visible":function(i){e.newFolderDialogVisible=i}}},[n("el-input",{attrs:{placeholder:"Folder Name"},model:{value:e.inputFolderName,callback:function(i){e.inputFolderName=i},expression:"inputFolderName"}}),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(i){e.newFolderDialogVisible=!1}}},[e._v("Cancel")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(i){e.clickNewFolder()}}},[e._v("Confirm")])],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"Create Success",visible:e.newFolderSuccessVisible,width:"50%"},on:{"update:visible":function(i){e.newFolderSuccessVisible=i}}},[n("span",[e._v("Create folder success!")])]),e._v(" "),n("el-dialog",{attrs:{title:"Create Fail",visible:e.newFolderFailVisible,width:"50%"},on:{"update:visible":function(i){e.newFolderFailVisible=i}}},[n("span",[e._v(e._s(e.newFolderFailMsg))])]),e._v(" "),n("el-dialog",{attrs:{title:"Upload Success",visible:e.uploadSuccessVisible,width:"50%"},on:{"update:visible":function(i){e.uploadSuccessVisible=i}}},[n("span",[e._v("Upload image success!")])]),e._v(" "),n("el-dialog",{attrs:{title:"Upload Fail",visible:e.uploadFailVisible,width:"50%"},on:{"update:visible":function(i){e.uploadFailVisible=i}}},[n("span",[e._v("Upload image fail: "+e._s(e.uploadFailMsg))])]),e._v(" "),n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.deleteDialogLoading,expression:"deleteDialogLoading"}],attrs:{title:"Delete Confirm",visible:e.deleteDialogVisible,width:"50%"},on:{"update:visible":function(i){e.deleteDialogVisible=i}}},[n("span",[e._v("Are you sure to delete?")]),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(i){e.deleteDialogVisible=!1}}},[e._v("Cancel")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(i){e.deletePath()}}},[e._v("Confirm")])],1)]),e._v(" "),n("el-dialog",{attrs:{title:"Delete Success",visible:e.deleteSuccessVisible,width:"50%"},on:{"update:visible":function(i){e.deleteSuccessVisible=i}}},[n("span",[e._v("Delete success!")])]),e._v(" "),n("el-dialog",{attrs:{title:"Delete Fail",visible:e.deleteFailVisible,width:"50%"},on:{"update:visible":function(i){e.deleteFailVisible=i}}},[n("span",[e._v("Delete image fail: "+e._s(e.deleteFailMsg))])])],1)},staticRenderFns:[]};var v=t("C7Lr")(h,m,!1,function(e){t("rNQF")},null,null).exports;n.default.use(o.a);var f=new o.a({routes:[{path:"/",name:"Index",component:v}]});t("/Hv2");n.default.use(p.a);var b=new p.a.Store({state:{isLogin:!1,username:"",curPath:"",dirs:[],photos:[]},getters:{isLogin:function(e){return e.isLogin},username:function(e){return e.username},dirs:function(e){return e.dirs},photos:function(e){return e.photos},curPath:function(e){return e.curPath}},mutations:{setUsername:function(e,i){e.username=i},setLogin:function(e,i){e.isLogin=i},setDirs:function(e,i){e.dirs=i},setPhotos:function(e,i){e.photos=i},setCurPath:function(e,i){e.curPath=i}},actions:{getInfo:function(e){var i=e.commit;g.a.get("/api/info").then(function(e){1===e.data.code&&(i("setLogin",e.data.data.isLogin),i("setUsername",e.data.data.username))})},login:function(e,i){var t=e.commit,n=i.username,a=i.password;return g.a.post("/api/login",{username:n,password:a}).then(function(e){if(1!==e.data.code||!e.data.data)return t("setLogin",!1),e.data.msg;t("setLogin",!0),t("setUsername",n)})},register:function(e,i){var t=e.commit,n=i.username,a=i.password;return g.a.post("/api/register",{username:n,password:a}).then(function(e){if(1!==e.data.code||!e.data.data)return t("setLogin",!1),e.data.msg;t("setLogin",!0),t("setUsername",n)})},getDir:function(e,i){var t=e.commit,n=i.path,a=void 0===n?"":n;return g.a.get("/api/getDir",{params:{path:a}}).then(function(e){return 1===e.data.code?(t("setDirs",e.data.data.filter(function(e){return e.checked=!1,1===e.type})),t("setPhotos",e.data.data.filter(function(e){return e.checked=!1,2===e.type})),t("setCurPath",a),"success"):e.data.msg})},newFolder:function(e,i){e.commit;var t=e.state,n=e.dispatch,a=i.path,s=void 0===a?"":a,o=i.dirName,l=void 0===o?"":o;return g.a.post("/api/createDir",{path:s,dirName:l}).then(function(e){return 1===e.data.code&&e.data.data?n("getDir",{path:t.curPath}):e.data.msg})},deletePath:function(e,i){e.commit;var t=e.dispatch,n=e.state,a=i.path,s=void 0===a?"":a;return g.a.post("/api/deleteDir",{path:s}).then(function(e){return 1===e.data.code?t("getDir",{path:n.curPath}):e.data.msg})},uploadImg:function(e,i){var t=e.state,n=e.dispatch;return g.a.post("/api/upload",i,{headers:{headers:{"Content-Type":"multipart/form-data"}}}).then(function(e){return 1===e.data.code?n("getDir",{path:t.curPath}):e.data.msg},function(e){return"server error"})},logout:function(e){var i=e.commit;return g.a.post("/api/logout").then(function(e){1===e.data.code&&(i("setLogin",!1),i("setUsername",""),i("setDirs",[]),i("setPhotos",[]))})}}});n.default.config.productionTip=!1,n.default.use(d.a),new n.default({el:"#app",router:f,store:b,components:{App:s},template:"<App/>"})},m6Gp:function(e,i){},plIk:function(e,i,t){e.exports=t.p+"static/img/logo.d449e99.svg"},rNQF:function(e,i){}},["NHnr"]);
//# sourceMappingURL=app.0844e8f9886469e2356e.js.map